MACRO(PICKUP_BENCHMARK FILE_NAME)

    get_filename_component(TARGET_NAME ${CMAKE_CURRENT_SOURCE_DIR} NAME)

    ADD_EXECUTABLE(${TARGET_NAME} ${FILE_NAME})
    DEAL_II_SETUP_TARGET(${TARGET_NAME})
    set_target_properties(${TARGET_NAME} PROPERTIES OUTPUT_NAME bench)
    TARGET_LINK_LIBRARIES(${TARGET_NAME} data_locality)

    FIND_LIBRARY(LIKWID likwid HINTS $ENV{LIKWID_LIB})

    IF(LIKWID)
      TARGET_COMPILE_DEFINITIONS(${TARGET_NAME} PUBLIC LIKWID_PERFMON)
      TARGET_INCLUDE_DIRECTORIES(${TARGET_NAME} PUBLIC $ENV{LIKWID_INCLUDE})
      TARGET_LINK_LIBRARIES(${TARGET_NAME} ${LIKWID})
    ENDIF() 

ENDMACRO(PICKUP_BENCHMARK)

MACRO(PICKUP_BENCHMARK_WITH_TEST FILE_NAME FILE_NAME_TEST)

    get_filename_component(TARGET_NAME ${CMAKE_CURRENT_SOURCE_DIR} NAME)

    ADD_EXECUTABLE(${TARGET_NAME} ${FILE_NAME})
    DEAL_II_SETUP_TARGET(${TARGET_NAME})
    set_target_properties(${TARGET_NAME} PROPERTIES OUTPUT_NAME bench)
    TARGET_LINK_LIBRARIES(${TARGET_NAME} data_locality)

    FIND_LIBRARY(LIKWID likwid HINTS $ENV{LIKWID_LIB})

    IF(LIKWID)
      TARGET_COMPILE_DEFINITIONS(${TARGET_NAME} PUBLIC LIKWID_PERFMON)
      TARGET_INCLUDE_DIRECTORIES(${TARGET_NAME} PUBLIC $ENV{LIKWID_INCLUDE})
      TARGET_LINK_LIBRARIES(${TARGET_NAME} ${LIKWID})
    ENDIF() 

    # test
    ADD_EXECUTABLE(${TARGET_NAME}_test ${FILE_NAME_TEST})
    DEAL_II_SETUP_TARGET(${TARGET_NAME}_test)
    set_target_properties(${TARGET_NAME}_test PROPERTIES OUTPUT_NAME test)
    TARGET_LINK_LIBRARIES(${TARGET_NAME}_test data_locality)

    SET(TEST_LIBRARIES data_locality)
    SET(TEST_TARGET ${TARGET_NAME}_test)
    DEAL_II_PICKUP_TESTS(${TARGET_NAME}_test)

ENDMACRO(PICKUP_BENCHMARK_WITH_TEST)
